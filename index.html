<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>RouteX VPN — Личный кабинет</title>
  <meta name="viewport" content="width=400, initial-scale=1">
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <style>
    :root{
      --bg-start:#0b1220; --bg-end:#0f172a; --text:#e5f1ff;
      --primary-1:#22d3ee; --primary-2:#0ea5b9; --accent:#84cc16;
      --panel:#0f172a; --panel-alpha:0.97; --border:#1f2c46;
      --text-dim:#9fb4d0; --link:#22d3ee; --link-2:#9ae6ff; --muted:#6b86a5;
    }
    body{
      background: radial-gradient(ellipse at 80% 0%, rgba(34,211,238,0.08) 0%, transparent 45%),
                  radial-gradient(ellipse at 15% 20%, rgba(132,204,22,0.05) 0%, transparent 40%),
                  radial-gradient(ellipse at center, var(--bg-start) 0%, var(--bg-end) 100%);
      color: var(--text); font-family:'Segoe UI',sans-serif; margin:0; padding:0; min-height:100vh;
    }
    .main-container{ max-width:400px; margin:0 auto; padding:0 0 24px 0; }
    .card{
      background: rgba(15,23,42,var(--panel-alpha));
      border-radius:18px; box-shadow:0 6px 32px #0008; padding:28px 18px 24px; margin-top:24px;
      border:1px solid rgba(255,255,255,0.06);
    }
    .logo-block{ text-align:center; margin-top:24px; position:relative; }
    .waves{ width:100px; height:100px; margin:0 auto; position:relative; z-index:0; }
    .logo-avatar{
      position:absolute; left:50%; top:50%; transform:translate(-50%,-50%);
      width:76px; height:76px; border-radius:50%;
      background:
        radial-gradient(60px 60px at 50% 45%, rgba(34,211,238,.14), transparent 70%),
        radial-gradient(34px 34px at 60% 40%, rgba(132,204,22,.12), transparent 75%),
        #0b1220;
      box-shadow:0 0 0 2px rgba(255,255,255,0.08), 0 10px 24px rgba(0,0,0,.35), 0 0 32px rgba(34,211,238,.12);
      overflow:hidden; z-index:1;
    }
    .logo-avatar img{
      position:absolute; left:50%; top:50%; transform:translate(-50%,-50%) scale(1.06);
      width:74%; height:auto; user-select:none; -webkit-user-drag:none;
      filter: drop-shadow(0 2px 6px rgba(0,0,0,.35));
    }

    .title{ font-size:1.4em; font-weight:700; margin-bottom:12px; }
    .subtitle{ color:var(--primary-1); font-size:1.07em; margin-bottom:8px; }
    .status{ color:var(--text-dim); font-size:0.93em; margin-bottom:10px; }
    .btn{
      width:100%; display:block; padding:14px 0; font-size:1.11em; font-weight:600;
      background:linear-gradient(90deg, var(--primary-2) 0%, var(--primary-1) 100%);
      color:#07131b; border:none; border-radius:12px; margin-top:12px; cursor:pointer;
      transition:background .18s; text-align:center; text-decoration:none; box-shadow:0 8px 22px rgba(34,211,238,.25);
    }
    .btn.secondary{ background:#111a2e; color:var(--link-2); border:1px solid var(--border); margin-top:10px; }
    .menu-row{ display:flex; flex-direction:column; gap:8px; margin-top:10px; }
    .menu-row .btn{ flex:none; width:100%; margin:0; }
    .profile-id{ font-size:0.98em; color:var(--link-2); word-break:break-all; }
    .linkbox{
      background:#0f2236; padding:10px; border-radius:8px; margin:10px 0;
      word-break:break-all; color:#fff; text-align:center; font-family:monospace; font-size:1.03em;
      border:1px solid rgba(255,255,255,0.08);
    }
    .faq-modal{ display:none; position:fixed; left:0; top:0; width:100vw; height:100vh; background:rgba(7,12,22,0.92); z-index:99; align-items:center; justify-content:center; }
    .faq-modal.active{ display:flex; }
    .faq-content{ background:#0f1f35; border-radius:14px; padding:22px 20px 18px; min-width:320px; max-width:98vw; border:1px solid rgba(255,255,255,0.08); }
    .faq-content h3{ margin:0 0 14px 0; }
    .faq-list{ list-style:none; padding:0; margin:0 0 14px 0; }
    .faq-list li{ padding:10px 0; border-bottom:1px solid var(--border); }
    .faq-list li:last-child{ border-bottom:none; }
    .faq-link{ color:var(--primary-1); cursor:pointer; text-decoration:underline; }
    .close-faq{ background:#111a2e; color:#fff; border:1px solid var(--border); border-radius:8px; padding:8px 14px; margin-top:10px; font-size:1em; cursor:pointer; display:block; margin-left:auto; margin-right:auto; }
    .footer{ text-align:center; color:var(--muted); font-size:0.92em; margin-top:30px; }
    a{ color:var(--link); text-decoration:underline; }
    @media (max-width:480px){ .main-container{ max-width:99vw; } .faq-content{ min-width:98vw; } }

    /* ====== СТИЛИ ДЛЯ СЕЛЕКТОРА КОЛИЧЕСТВА УСТРОЙСТВ ====== */
    .devices-wrap{ margin:8px 0 12px; }
    .devices-label{ font-size:.95em; color:var(--text-dim); margin-bottom:6px; }
    .device-slider{
      position:relative; height:36px; border-radius:18px; background:#0e2031; border:1px solid rgba(255,255,255,0.08);
      display:flex; align-items:center; padding:0 12px; box-shadow: inset 0 0 0 1px rgba(255,255,255,0.02);
    }
    .device-slider .dots{ position:absolute; left:12px; right:12px; display:flex; justify-content:space-between; pointer-events:none; }
    .device-slider .dots span{ width:8px; height:8px; border-radius:50%; background:#24425d; }
    .device-slider input[type=range]{
      -webkit-appearance:none; appearance:none; width:100%; background:transparent; position:relative; z-index:2;
    }
    .device-slider input[type=range]::-webkit-slider-runnable-track{ height:6px; background:linear-gradient(90deg, var(--primary-2), var(--primary-1)); border-radius:999px; }
    .device-slider input[type=range]::-moz-range-track{ height:6px; background:linear-gradient(90deg, var(--primary-2), var(--primary-1)); border-radius:999px; }
    .device-slider input[type=range]::-webkit-slider-thumb{
      -webkit-appearance:none; appearance:none; width:22px; height:22px; border-radius:50%; background:#0b1220;
      border:2px solid var(--primary-1); margin-top:-8px; box-shadow:0 2px 10px rgba(34,211,238,.35);
    }
    .device-slider input[type=range]::-moz-range-thumb{
      width:22px; height:22px; border-radius:50%; background:#0b1220; border:2px solid var(--primary-1); box-shadow:0 2px 10px rgba(34,211,238,.35);
    }
    .plan-note{ color:var(--text-dim); font-size:.88em; }
    .permonth{ color:var(--text-dim); }
  </style>
</head>
<body>
  <div class="main-container">

    <!-- ЛОГО -->
    <div class="logo-block">
      <div class="waves">
        <svg width="100" height="100">
          <circle cx="50" cy="50" r="40" fill="none" stroke="#0ea5b9" stroke-width="2" opacity="0.35">
            <animate attributeName="r" values="40;48;40" dur="2s" repeatCount="indefinite"/>
            <animate attributeName="opacity" values="0.3;0.1;0.3" dur="2s" repeatCount="indefinite"/>
          </circle>
          <circle cx="50" cy="50" r="28" fill="none" stroke="#22d3ee" stroke-width="2" opacity="0.6">
            <animate attributeName="r" values="28;35;28" dur="2s" repeatCount="indefinite"/>
            <animate attributeName="opacity" values="0.5;0.15;0.5" dur="2s" repeatCount="indefinite"/>
          </circle>
        </svg>
        <div class="logo-avatar">
          <img src="./logo_shield.webp" alt="RouteX VPN">
        </div>
      </div>
    </div>

    <!-- ГЛАВНАЯ -->
    <div class="card" id="main-section">
      <div class="title">RouteX VPN</div>
      <div class="status">Пробный период до <span id="expire-date">9 августа 2025</span></div>
      <a class="btn" href="#" onclick="showSection('buy')">Купить подписку</a>
      <div class="menu-row">
        <button class="btn secondary" onclick="showSection('setup')">Установка и настройка</button>
        <button class="btn secondary" onclick="showSection('profile')">Профиль</button>
        <button class="btn secondary" onclick="showFaq()">Поддержка</button>
      </div>
    </div>

    <!-- ПОКУПКА ПОДПИСКИ -->
    <div class="card" id="buy-section" style="display:none;">
      <div class="title">Покупка подписки</div>
      <div class="plan-note">Выберите тариф и количество устройств</div>

      <!-- Новый селектор количества устройств -->
      <div class="devices-wrap">
        <div class="devices-label">Количество устройств: <b><span id="deviceCountLabel">1</span></b></div>
        <div class="device-slider">
          <div class="dots"><span></span><span></span><span></span><span></span><span></span></div>
          <input id="deviceCount" type="range" min="1" max="5" step="1" value="1">
        </div>
      </div>

      <!-- Кнопки тарифов -->
      <div class="menu-row" style="margin-bottom:12px;">
        <button class="btn" id="plan-1" onclick="selectPlan(1)">—</button>
        <button class="btn" id="plan-3" onclick="selectPlan(3)">—</button>
      </div>
      <div class="menu-row" style="margin-bottom:12px;">
        <button class="btn" id="plan-6" onclick="selectPlan(6)">—</button>
        <button class="btn" id="plan-12" onclick="selectPlan(12)">—</button>
      </div>

      <button class="btn" id="payBtn" style="margin-top:10px;">Оплатить</button>
      <button class="btn secondary" onclick="showSection('main')">Назад</button>
    </div>

    <!-- УСТАНОВКА -->
    <div class="card" id="setup-section" style="display:none;">
      <div class="title">Установка и настройка</div>
      <div class="subtitle">VPN для вашего устройства в 3 шага</div>
      <button class="btn" onclick="window.open('https://teletype.in/@ultimavpn/main','_blank')">Инструкция для всех платформ</button>
      <button class="btn secondary" onclick="showSection('main')">Назад</button>
    </div>

    <!-- ПРОФИЛЬ -->
    <div class="card" id="profile-section" style="display:none;">
      <div class="title" id="username">Пользователь</div>
      <div class="profile-id" id="userid">id: —</div>
      <div class="menu-row" style="margin-top:18px;">
        <button class="btn secondary" onclick="showSection('buy')">Оплата</button>
        <button class="btn secondary" onclick="window.open('https://teletype.in/@ultimavpn/main','_blank')">Инструкция</button>
      </div>
      <div class="menu-row" style="margin-top:10px;">
        <button class="btn secondary" onclick="window.open('https://t.me/your_support_username','_blank')">Поддержка</button>
        <button class="btn secondary" onclick="window.open('https://t.me/your_referral','_blank')">Реферальная программа</button>
      </div>
      <div style="margin:12px 0 5px 0;">
        <div style="font-size:0.98em; color:#e5fffb;">Ссылка на подключение:</div>
        <div class="linkbox" id="vpnlink">https://vpn.routex.app/abc123</div>
      </div>
      <button class="btn secondary" onclick="showSection('main')">Назад</button>
    </div>

    <!-- FAQ -->
    <div class="faq-modal" id="faq-modal">
      <div class="faq-content">
        <h3>Ответы на частые вопросы</h3>
        <ul class="faq-list">
          <li><span class="faq-link" onclick="window.open('https://teletype.in/@ultimavpn/main#more','_blank')">Как подключить VPN на дополнительные устройства?</span></li>
          <li><span class="faq-link" onclick="window.open('https://te
